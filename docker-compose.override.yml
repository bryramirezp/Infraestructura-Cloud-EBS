services:
  backend:
    # El entrypoint.sh detecta ENVIRONMENT=development y ejecuta uvicorn con --reload automáticamente
    # No necesitamos sobrescribir el command, el entrypoint.sh lo maneja
    
    # Volumen para hot-reload: mapea SOLO el código de la app, NO el entrypoint.sh
    # El entrypoint.sh debe estar en la imagen para evitar problemas de permisos en Windows
    volumes:
      - ./backend/app:/app/app:rw

    # Entorno específico de desarrollo
    # El entrypoint.sh detecta esto y ejecuta: uvicorn app.main:app --reload
    environment:
      - ENVIRONMENT=development